<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Bootstrap -->
    <link href="assets/css/bootstrap.min.css" rel="stylesheet">
    <link href="assets/css/bootstrap-select.css" rel="stylesheet">
    <!-- font awesome for icons -->
    <link href="assets/css/font-awesome.min.css" rel="stylesheet">
    <!-- flex slider css -->
    <link href="assets/css/flexslider.css" rel="stylesheet" type="text/css" media="screen">
    <!-- animated css  -->
    <link href="assets/css/animate.css" rel="stylesheet" type="text/css" media="screen">
    <!-- Revolution Style-sheet -->
    <link href="assets/rs-plugin/css/settings.css" rel="stylesheet" type="text/css">
    <link href="assets/css/rev-style.css" rel="stylesheet" type="text/css">
    <!--owl carousel css-->
    <link href="assets/owl-carousel/dist/assets/owl.carousel.css" rel="stylesheet" type="text/css" media="screen">
    <link href="assets/owl-carousel/dist/assets/owl.theme.default.css" rel="stylesheet" type="text/css" media="screen">
    <!--mega menu -->
    <link href="assets/css/yamm.css" rel="stylesheet" type="text/css">
    <!--cube css-->
    <link href="assets/cubeportfolio/css/cubeportfolio.min.css" rel="stylesheet" type="text/css">
    <!-- custom css-->
    <link href="assets/css/components.css" rel="stylesheet" type="text/css" media="screen">
    <link href="assets/css/style.css" rel="stylesheet" type="text/css" media="screen">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->
</head>

<body>
    <div class="top-bar-light">
        <div class="container">
            <div class="row">
                <div class="col-sm-4 hidden-xs">
                    <div class="top-bar-socials">
                        <a href="#" class="social-icon-sm si-dark si-gray-round si-colored-facebook">
                            <i class="fa fa-facebook"></i>
                            <i class="fa fa-facebook"></i>
                        </a>
                        <a href="#" class="social-icon-sm si-dark si-gray-round si-colored-twitter">
                            <i class="fa fa-twitter"></i>
                            <i class="fa fa-twitter"></i>
                        </a>
                        <a href="#" class="social-icon-sm si-dark si-gray-round si-colored-google-plus">
                            <i class="fa fa-youtube"></i>
                            <i class="fa fa-youtube"></i>
                        </a>
                        <a href="#" class="social-icon-sm si-dark si-gray-round si-colored-instagram">
                            <i class="fa fa-instagram"></i>
                            <i class="fa fa-instagram"></i>
                        </a>
                    </div>
                </div>
                <div class="col-sm-8 text-right">
                    <ul class="list-inline top-dark-right">
                        <li class="hidden-sm hidden-xs"><i class="fa fa-envelope"></i> proeduca@gmail.com</li>
                        <li class="hidden-sm hidden-xs"><i class="fa fa-phone"></i> 999 999 999 </li>
                        <li><a class="topbar-icons" href="#"><span><i class="fa fa-search top-search"></i></span></a>
                        </li>
                    </ul>
                    <div class="search">
                        <form role="form">
                            <input type="text" class="form-control" autocomplete="off" placeholder="Buscar">
                            <span class="search-close"><i class="fa fa-times"></i></span>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--<div class="navbar navbar-default navbar-static-top yamm sticky" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
            </div>
            <div class="navbar-collapse collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li class=" "><a href="index.html">Inicio</a></li>
                    <li class="active">
                        <a href="nosotros.html">Nosotros</a>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle " data-toggle="dropdown">Evaluaciones <i
                                class="fa fa-angle-down"></i></a>
                        <ul class="dropdown-menu" role="menu">
                            <li><a href="#"> Rendir Evaluación</a></li>
                            <li><a href="#"> AutoEvaluación</a></li>
                            <li><a href="#"> Historial de Evaluaciones</a></li>
                        </ul>
                    </li>                  
                </ul>
            </div>

        </div>-->
        <!--container-->
    </div>
    <!--rev slider start-->
    <br>
    <section class="container">
        <div class="form-row">
            <div class="form-group">
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <p>Especificaciones de la evaluación:</p>
                        <p>1. El alumno podrá rendir la evaluación en el tiempo establecido.</p>
                        <p>2. Una vez culminado el tiempo, se enviará automáticamente el resultado de evaluación</p>
                        <p>Tiempo transcurrido: <span id="cronometroMinutos"></span></p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="container">
            <div class="form-row">
                <ul class="nav nav-tabs">
            
                </ul>
            </div>

        <div id="tabsPreguntas">
        </div>
        <div class='form-row'><div class='form-group'><button id='btnEnviarPrueba' class='btn btn-primary'>Enviar</button></div></div>

</section>
<footer class="container-fluid ">

<div class="row ">
    <div class="col-md-12 text-center ">
        <ul class="d-inline-block copyrigth ">
            <li>ProEduca>
            <li>©Copyright 2020</li>
            <!-- <li>Developed By Kreatico</li> -->
                </ul>

            </div>
        </div>
    </footer>

    <script src="assets/js/jquery.min.js "></script>
    <script src="assets/js/jquery-migrate.min.js "></script>
    <!--bootstrap js plugin-->
    <script src="assets/js/bootstrap.min.js " type="text/javascript "></script>
    <!--easing plugin for smooth scroll-->
    <script src="assets/js/jquery.easing.1.3.min.js " type="text/javascript "></script>
    <!--sticky header-->
    <script type="text/javascript " src="assets/js/jquery.sticky.js "></script>
    <!--flex slider plugin-->
    <script src="assets/js/jquery.flexslider-min.js " type="text/javascript "></script>
    <!--parallax background plugin-->
    <script src="assets/js/jquery.stellar.min.js " type="text/javascript "></script>
    <!--digit countdown plugin-->
    <script src="assets/js/waypoints.min.js "></script>
    <!--digit countdown plugin-->
    <script src="assets/js/jquery.counterup.min.js " type="text/javascript "></script>
    <!--on scroll animation-->
    <script src="assets/js/wow.min.js " type="text/javascript "></script>
    <!--owl carousel slider-->
    <script src="assets/owl-carousel/dist/owl.carousel.min.js " type="text/javascript "></script>
    <!--popup js-->
    <script src="assets/js/jquery.magnific-popup.min.js " type="text/javascript "></script>
    <!--customizable plugin edit according to your needs-->
    <script src="assets/js/custom.js " type="text/javascript "></script>
    <script type="text/javascript " src="assets/rs-plugin/js/jquery.themepunch.tools.min.js "></script>
    <script type="text/javascript " src="assets/rs-plugin/js/jquery.themepunch.revolution.min.js "></script>
    <script type="text/javascript " src="assets/rs-plugin/videojs/video.js "></script>
    <script type="text/javascript " src="assets/js/revolution-custom.js "></script>
    <script src="assets/js/bootstrap-select.min.js " type="text/javascript "></script>
    <script src="assets/js/jquery-ui.min.js " type="text/javascript "></script>
    <script src="assets/cubeportfolio/js/jquery.cubeportfolio.min.js " type="text/javascript "></script>
    <script src="assets/js/cube-portfolio.js " type="text/javascript "></script>
    <script src="assets/js/pace.min.js " type="text/javascript "></script>

    <script type="text/javascript">
       var cronometro;
       var cronometroMinutos = localStorage.getItem("duracion")
       var evaluacion = localStorage.getItem("idEvaluacion")
       var idusuario =  localStorage.getItem("idusuario")
       var fechaEvaluacion = localStorage.getItem("fechaEvaluacion");
       var nombrenivel = localStorage.getItem("nombrenivel");


       document.getElementById("cronometroMinutos").innerHTML = parseInt(cronometroMinutos);
        iniciarCronometro();
        MostrarPreguntas();

       function iniciarCronometro(){
       var mp = parseInt($("#cronometroMinutos").html());

       cronometro = setInterval(function(){
         
         if(mp == 1){
              clearInterval(cronometro);
              //window.location.href = 'ResultadosEvaluacion.html'

         }
         mp--;
         $("#cronometroMinutos").html(mp);
         if(mp<10){
            $("#cronometroMinutos").html(" 0"+mp);
         }
       },1000)
       }

        $(document).ready(function () {
            $("#tbPersona").html('');
            $("#tbRubro").html('');
            $("#tbBanco").html('');
            $("#tbCombo").html('');
            $("#tabsPreguntas").tabs();

        });

         $( "#btnEnviarPrueba" ).click(function() {
              var idpregunta = "";
              var idrespuesta = "";
              var puntaje = "";
              var x = 0;

              var listPuntajes = [];

               $.get( "http://localhost:8080/api/evaluacionmostrar/" + evaluacion, function(data){
                  for(var i=0; i<data.length; i++)
                  {
                     if(data[i].idrespuesta == 0)
                     {
                        x++;
                     }
                  }
                  for(var k=0; k<data.length; k++)
                  {
                     if(data[k].idrespuesta == 0)
                     {
                         idpregunta = data[k].idpregunta
                         for(var j=0; j<x; j++)
                         {
                            if($("#rdOpcion" + data[parseInt(k+j+1)].idrespuesta).is(":checked"))
                            {
                               idrespuesta = $("#rdOpcion" + data[parseInt(k+j+1)].idrespuesta).val();
                               break;
                            }
                            else
                            {
                               idrespuesta = 0;
                            }
                         }

                         var evaluacionrespuestausuario =
                         {
                            "idevaluacion": evaluacion,
                            "idpregunta" : idpregunta,
                            "idrespuesta": idrespuesta,
                            "idusuario" : idusuario
                         }

                         listPuntajes.push(evaluacionrespuestausuario)
                     }
                  }
                  InsertarEvaluacion(listPuntajes)
                  window.location.href = 'ResultadosEvaluacion.html';
              });

         });


        function InsertarEvaluacion(listaPuntajes)
        {
           for(var x=0; x<listaPuntajes.length; x++)
           {
                var datos =
                {
                   "idevaluacion": parseInt(listaPuntajes[x].idevaluacion),
                   "idpregunta" :  parseInt(listaPuntajes[x].idpregunta),
                   "idrespuesta":  parseInt(listaPuntajes[x].idrespuesta),
                   "idusuario" : parseInt(listaPuntajes[x].idusuario),
                   "puntaje": 0,
                   "orden": 1
                };

                $.ajax({
                    url: "http://localhost:8080/api/evaluacionrespuesta_reg",
                    type: 'post',
                    dataType: 'json',
                    contentType: 'application/json',
                    success: function (data) {

                    },
                    data: JSON.stringify(datos)
                });

           }
        }

        function  MostrarPreguntas(listPuntajes){
        var x = 0;
        var tr = "";
         $.get( "http://localhost:8080/api/evaluacionmostrar/" + evaluacion, function(data){
              if(data.length == 0)
              {
                 window.location.href = 'ExamenNoProgramado.html'
              }
              else{

              for(var k=0; k<data.length; k++)
              {
                if(data[k].idrespuesta == 0)
                {
                   //Recorrer fila de preguntas
                   tr += "<div class='form-row'><div class='form-group'><div class='panel panel-default'><div class='panel-heading' id='" + data[k].idpregunta + "'><strong>Pregunta " + data[k].numero + "</strong><p>" + data[k].descripcion + "</p></div>";
                   tr += "<div class='panel-heading' id='clavespregunta" + data[k].idpregunta +"'>";
                   for(var j=0; j<5; j++)
                   {
                      //Formar las alternativas por cada pregunta
                      tr += "<input type='radio' name='rdOpcion" + data[k].idpregunta + "'  id='rdOpcion" + data[parseInt(k+j+1)].idrespuesta + "' value='" + data[parseInt(k+j+1)].idrespuesta + "'>" + " " + data[parseInt(k+j+1)].descripcion + "</input><br>";
                   }

                   tr += "</div></div></div></div>";
                }

              }
            }

              $("#tabsPreguntas").append(tr);



           });

        }
    </script>
</body>

</html>